C51 COMPILER V9.54   IR                                                                    12/31/2022 21:29:44 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE IR
OBJECT MODULE PLACED IN .\Objects\IR.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE IR.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\IR.lst
                    -) OBJECT(.\Objects\IR.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "Timer0.h"
   3          #include "Int0.h"
   4          #include "IR.h"
   5          
   6          unsigned int IR_Time;
   7          unsigned char IR_State=0;
   8          
   9          unsigned char IR_Data[4];
  10          unsigned char IR_pData;
  11          
  12          unsigned char IR_DataFlag;
  13          unsigned char IR_RepeatFlag;
  14          
  15          unsigned char IR_Address;
  16          unsigned char IR_Command;
  17          
  18          void IR_Init(void)
  19          {
  20   1              Timer0_Init();
  21   1              Int0_Init();
  22   1      }
  23          
  24          unsigned char IR_GetDataFlag(void)
  25          {
  26   1              if(IR_DataFlag)
  27   1              {
  28   2                      IR_DataFlag=0;
  29   2                      return 1;
  30   2              }
  31   1              return 0;
  32   1      }
  33          
  34          unsigned char IR_GetRepeatFlag(void)
  35          {
  36   1              if(IR_RepeatFlag)
  37   1              {
  38   2                      IR_RepeatFlag=0;
  39   2                      return 1;
  40   2              }
  41   1              return 0;
  42   1      }
  43          
  44          unsigned char IR_GetAddress(void)
  45          {
  46   1              return IR_Address;
  47   1      }
  48          
  49          unsigned char IR_GetCommand(void)
  50          {
  51   1              return IR_Command;
  52   1      }
  53          
  54          //Â§ñÈÉ®‰∏≠Êñ≠0‰∏≠Êñ≠ÂáΩÊï∞Ôºå‰∏ãÈôçÊ≤øËß¶ÂèëÊâßË°å
C51 COMPILER V9.54   IR                                                                    12/31/2022 21:29:44 PAGE 2   

  55          void Int0_Routine(void) interrupt 0
  56          {
  57   1              if(IR_State==0)                         //Áä∂ÊÄÅ0ÔºåÁ©∫Èó≤Áä∂ÊÄÅ
  58   1              {       
  59   2                      Timer0_SetCounter(0);   //ÂÆöÊó∂ËÆ°Êï∞Âô®Ê∏Ö0
  60   2                      Timer0_Run(1);                  //ÂÆöÊó∂Âô®ÂêØÂä®
  61   2                      IR_State=1;                             //ÁΩÆÁä∂ÊÄÅ‰∏∫1
  62   2              }       
  63   1              else if(IR_State==1)
  64   1              {       
  65   2                      IR_Time=Timer0_GetCounter();    //Ëé∑Âèñ‰∏ä‰∏ÄÊ¨°‰∏≠Êñ≠Âà∞Ê≠§Ê¨°‰∏≠Êñ≠ÁöÑÊó∂Èó¥ 
  66   2                      Timer0_SetCounter(0);   //ÂÆöÊó∂ËÆ°Êï∞Âô®Ê∏Ö0
  67   2                      //Â¶ÇÊûúËÆ°Êó∂‰∏∫13.5msÔºåÂàôÊé•Êî∂Âà∞‰∫ÜStart‰ø°Âè∑ÔºàÂà§ÂÆöÂÄºÂú®12MHzÊô∂ÊåØ‰∏ã‰∏∫13500ÔºåÂú®11.0592MH
             -zÊô∂ÊåØ‰∏ã‰∏∫12442Ôºâ
  68   2                      if(IR_Time>12442-500 && IR_Time<12442+500)
  69   2                      {
  70   3                              IR_State=2;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫2
  71   3                      }
  72   2                      //Â¶ÇÊûúËÆ°Êó∂‰∏∫11.25msÔºåÂàôÊé•Êî∂Âà∞‰∫ÜRepeat‰ø°Âè∑ÔºàÂà§ÂÆöÂÄºÂú®12MHzÊô∂ÊåØ‰∏ã‰∏∫11250ÔºåÂú®11.0592
             -MHzÊô∂ÊåØ‰∏ã‰∏∫10368Ôºâ
  73   2                      else if(IR_Time>10368-500 && IR_Time<10368+500)
  74   2                      {
  75   3                              IR_RepeatFlag=1;        //ÁΩÆÊî∂Âà∞ËøûÂèëÂ∏ßÊ†áÂøó‰Ωç‰∏∫1
  76   3                              Timer0_Run(0);          //ÂÆöÊó∂Âô®ÂÅúÊ≠¢
  77   3                              IR_State=0;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫0
  78   3                      }
  79   2                      //Â¶ÇÊûúËÆ°Êó∂‰∏∫11.25msÔºåÂàôÊé•Êî∂Âà∞‰∫ÜRepeat‰ø°Âè∑ÔºàÂà§ÂÆöÂÄºÂú®12MHzÊô∂ÊåØ‰∏ã‰∏∫11250ÔºåÂú®11.0592
             -MHzÊô∂ÊåØ‰∏ã‰∏∫10368Ôºâ
  80   2                      else if(IR_Time>10368-500 && IR_Time<10368+500)
  81   2                      {
  82   3                              IR_RepeatFlag=1;        //ÁΩÆÊî∂Âà∞ËøûÂèëÂ∏ßÊ†áÂøó‰Ωç‰∏∫1
  83   3                              Timer0_Run(0);          //ÂÆöÊó∂Âô®ÂÅúÊ≠¢
  84   3                              IR_State=0;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫0
  85   3                      }
  86   2                      else                                    //Êé•Êî∂Âá∫Èîô
  87   2                      {
  88   3                              IR_State=1;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫1
  89   3                      }
  90   2              }
  91   1              else if(IR_State==2)    
  92   1              {
  93   2                      IR_Time=Timer0_GetCounter();    //Ëé∑Âèñ‰∏ä‰∏ÄÊ¨°‰∏≠Êñ≠Âà∞Ê≠§Ê¨°‰∏≠Êñ≠ÁöÑÊó∂Èó¥
  94   2                      Timer0_SetCounter(0);   //ÂÆöÊó∂ËÆ°Êï∞Âô®Ê∏Ö0
  95   2                      //Â¶ÇÊûúËÆ°Êó∂‰∏∫1120usÔºåÂàôÊé•Êî∂Âà∞‰∫ÜÊï∞ÊçÆ0ÔºàÂà§ÂÆöÂÄºÂú®12MHzÊô∂ÊåØ‰∏ã‰∏∫1120ÔºåÂú®11.0592MHzÊô∂Ê
             -åØ‰∏ã‰∏∫1032Ôºâ
  96   2                      if(IR_Time>1032-500 && IR_Time<1032+500)
  97   2                      {
  98   3                              IR_Data[IR_pData/8]&=~(0x01<<(IR_pData%8));     //Êï∞ÊçÆÂØπÂ∫î‰ΩçÊ∏Ö0
  99   3                              IR_pData++;     //Êï∞ÊçÆ‰ΩçÁΩÆÊåáÈíàËá™Â¢û
 100   3                      }
 101   2                      //Â¶ÇÊûúËÆ°Êó∂‰∏∫2250usÔºåÂàôÊé•Êî∂Âà∞‰∫ÜÊï∞ÊçÆ1ÔºàÂà§ÂÆöÂÄºÂú®12MHzÊô∂ÊåØ‰∏ã‰∏∫2250ÔºåÂú®11.0592MHzÊô∂Ê
             -åØ‰∏ã‰∏∫2074Ôºâ
 102   2                      else if(IR_Time>2074-500 && IR_Time<2074+500)
 103   2                      {
 104   3                              IR_Data[IR_pData/8]|=(0x01<<(IR_pData%8));      //Êï∞ÊçÆÂØπÂ∫î‰ΩçÁΩÆ1
 105   3                              IR_pData++;                     //Êï∞ÊçÆ‰ΩçÁΩÆÊåáÈíàËá™Â¢û
 106   3                      }
 107   2                      else                                    //Êé•Êî∂Âá∫Èîô
 108   2                      {
 109   3                              IR_pData=0;                     //Êï∞ÊçÆ‰ΩçÁΩÆÊåáÈíàÊ∏Ö0
 110   3                              IR_State=1;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫1
 111   3                      }
C51 COMPILER V9.54   IR                                                                    12/31/2022 21:29:44 PAGE 3   

 112   2                      if(IR_pData>=32)                //Â¶ÇÊûúÊé•Êî∂Âà∞‰∫Ü32‰ΩçÊï∞ÊçÆ
 113   2                      {
 114   3                              IR_pData=0;                     //Êï∞ÊçÆ‰ΩçÁΩÆÊåáÈíàÊ∏Ö0
 115   3                              if((IR_Data[0]==~IR_Data[1]) && (IR_Data[2]==~IR_Data[3]))      //Êï∞ÊçÆÈ™åËØÅ
 116   3                              {
 117   4                                      IR_Address=IR_Data[0];  //ËΩ¨Â≠òÊï∞ÊçÆ
 118   4                                      IR_Command=IR_Data[2];
 119   4                                      IR_DataFlag=1;  //ÁΩÆÊî∂Âà∞ËøûÂèëÂ∏ßÊ†áÂøó‰Ωç‰∏∫1
 120   4                              }
 121   3                              Timer0_Run(0);          //ÂÆöÊó∂Âô®ÂÅúÊ≠¢
 122   3                              IR_State=0;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫0
 123   3                      }
 124   2              }
 125   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    396    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
